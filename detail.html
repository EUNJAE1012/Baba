<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>ìƒì„¸ ì •ë³´</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
      }
      h2 {
        margin-bottom: 10px;
      }
      .info {
        margin-bottom: 20px;
      }
      .button {
        padding: 10px 20px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        margin-right: 10px;
      }
      .button:hover {
        background-color: #0056b3;
      }
      .image {
        width: 100%;
        height: auto;
        margin-bottom: 20px;
      }
    </style>
  </head>
  <body>
    <h2 id="place-name"></h2>
    <!-- ì´ë¯¸ì§€ í‘œì‹œ -->
    <img id="place-image" class="image" src="" alt="ìƒì„¸ ì´ë¯¸ì§€" />
    <div class="info">
      <p><strong>ì£¼ì†Œ:</strong> <span id="place-address"></span></p>
      <p><strong>ì „í™”ë²ˆí˜¸:</strong> <span id="place-tel"></span></p>
      <p><strong>ì†Œê°œ:</strong> <span id="place-description"></span></p>
    </div>
    <button class="button" id="hotspot-btn">í•«í”Œë¡œ ì¶”ì²œ</button>
    <button class="button" id="add-plan-btn">ë‚´ ì—¬í–‰ ê³„íš ëª©ë¡ì— ì¶”ê°€</button>

    <script>
      window.addEventListener("load", function () {
        // URL ë§¤ê°œë³€ìˆ˜ì—ì„œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        const urlParams = new URLSearchParams(window.location.search);

        if (urlParams.has("label")) {
          // URL ë§¤ê°œë³€ìˆ˜ì—ì„œ ë°ì´í„° ì¶”ì¶œ
          const label = urlParams.get("label");
          const address = urlParams.get("address");
          const tel = urlParams.get("tel");
          const imageUrl = urlParams.get("imageUrl");

          // í™”ë©´ì— ì •ë³´ í‘œì‹œ
          document.getElementById("place-name").textContent = label;
          document.getElementById("place-address").textContent = address;
          document.getElementById("place-tel").textContent = tel;
          document.getElementById("place-image").src = imageUrl;

          // "í•«í”Œë¡œ ì¶”ì²œ" ë²„íŠ¼ í´ë¦­ ì‹œ ì´ë²¤íŠ¸
          document.getElementById("hotspot-btn").addEventListener("click", function () {
            alert(`ğŸ’¡ í•«í”Œë¡œ ì¶”ì²œ: ${label}`);
          });

          // "ë‚˜ì˜ ì—¬í–‰ ê³„íšì— ì¶”ê°€" ë²„íŠ¼ í´ë¦­ ì‹œ, ì—¬í–‰ ê³„íš ëª©ë¡ì— ì¶”ê°€
          document.getElementById("add-plan-btn").addEventListener("click", function () {
            if (window.opener) {
              const planList = window.opener.document.querySelector(".plan-items");
              if (planList) {
                // "ê³„íšì´ ì—†ìŠµë‹ˆë‹¤" í…ìŠ¤íŠ¸ê°€ ìˆì„ ê²½ìš° ì œê±°
                const noPlanText = window.opener.document.querySelector(".no-plan-text");
                if (noPlanText) {
                  noPlanText.remove(); // ê¸°ì¡´ í…ìŠ¤íŠ¸ ì‚­ì œ
                }
                const planCard = document.createElement("div");
                planCard.classList.add("plan-card");
                let category = "myTrip";
                planCard.innerHTML = `
                  <img src="${imageUrl}" alt="${label}" class="location-img" />
                  <h3>${category} - ${label}</h3>
                  <p>${address}</p>
                  <p>${tel}</p>
                `;
                planList.appendChild(planCard);
                window.close(); // ìì‹ ì°½ ë‹«ê¸°
              } else {
                alert("ë¶€ëª¨ ì°½ì—ì„œ ê³„íš ëª©ë¡ ìš”ì†Œ(.plan-items)ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
              }
            } else {
              alert("ë¶€ëª¨ ì°½ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }
          });
        } else if (window.opener && window.opener.info) {
          // ê¸°ì¡´ ë°©ì‹ì˜ info ê°ì²´ ì²˜ë¦¬ (ì´ì „ ë°©ì‹ê³¼ì˜ í˜¸í™˜ì„± ìœ ì§€)
          const info = window.opener.info;

          document.getElementById("place-name").textContent = info.label;
          document.getElementById("place-address").textContent = info.address;
          document.getElementById("place-tel").textContent = info.tel;
          document.getElementById("place-image").src = info.imageUrl;

          // ë²„íŠ¼ ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ ë“±ë¡
          document.getElementById("hotspot-btn").addEventListener("click", function () {
            alert(`ğŸ’¡ í•«í”Œë¡œ ì¶”ì²œ: ${info.label}`);
          });

          document.getElementById("add-plan-btn").addEventListener("click", function () {
            const planList = window.opener.document.querySelector(".plan-items");
            if (planList) {
              const planItem = document.createElement("div");
              planItem.textContent = info.label;
              planList.appendChild(planItem);
              window.close();
            } else {
              alert("ë¶€ëª¨ ì°½ì—ì„œ ê³„íš ëª©ë¡ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
            }
          });
        } else {
          alert("ìƒì„¸ ì •ë³´ê°€ ì „ë‹¬ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");
        }
      });
    </script>
  </body>
</html>
